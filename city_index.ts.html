<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>city/index.ts - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/novlan1/t-comm" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="MorsePwd.html">MorsePwd</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MorsePwd.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="MorsePwd.html#clear">clear</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#parseFunction">parseFunction</a></li><li><a href="global.html#flatten">flatten</a></li><li><a href="global.html#shuffle">shuffle</a></li><li><a href="global.html#isListAllEqual">isListAllEqual</a></li><li><a href="global.html#getKeyValuesMap">getKeyValuesMap</a></li><li><a href="global.html#getPreviousRatio">getPreviousRatio</a></li><li><a href="global.html#getMaxAndMinIdx">getMaxAndMinIdx</a></li><li><a href="global.html#flattenPreData">flattenPreData</a></li><li><a href="global.html#getUnitPreviousRatio">getUnitPreviousRatio</a></li><li><a href="global.html#NUMBER_CHI_MAP">NUMBER_CHI_MAP</a></li><li><a href="global.html#toHumpObj">toHumpObj</a></li><li><a href="global.html#toUnicodeAt">toUnicodeAt</a></li><li><a href="global.html#toUnicode">toUnicode</a></li><li><a href="global.html#getAccCellWidth">getAccCellWidth</a></li><li><a href="global.html#mergeMultiCanvasPic">mergeMultiCanvasPic</a></li><li><a href="global.html#createCanvasTable">createCanvasTable</a></li><li><a href="global.html#getAreaData">getAreaData</a></li><li><a href="global.html#getAllAreaData">getAllAreaData</a></li><li><a href="global.html#getAreaCode">getAreaCode</a></li><li><a href="global.html#getProvName">getProvName</a></li><li><a href="global.html#getCityName">getCityName</a></li><li><a href="global.html#getAreaName">getAreaName</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html#setCookie">setCookie</a></li><li><a href="global.html#clearCookie">clearCookie</a></li><li><a href="global.html#clearAll">clearAll</a></li><li><a href="global.html#uploadCOSFile">uploadCOSFile</a></li><li><a href="global.html#removeCss">removeCss</a></li><li><a href="global.html#getMonthDay">getMonthDay</a></li><li><a href="global.html#getMonthDay2">getMonthDay2</a></li><li><a href="global.html#isSameWeek">isSameWeek</a></li><li><a href="global.html#timeStampFormat">timeStampFormat</a></li><li><a href="global.html#dateFormat">dateFormat</a></li><li><a href="global.html#parseTime">parseTime</a></li><li><a href="global.html#getTimeAgo">getTimeAgo</a></li><li><a href="global.html#getTimeAgoOrDate">getTimeAgoOrDate</a></li><li><a href="global.html#getCountDownObj">getCountDownObj</a></li><li><a href="global.html#getRealUA">getRealUA</a></li><li><a href="global.html#checkUAIsIOS">checkUAIsIOS</a></li><li><a href="global.html#getEnvUAType">getEnvUAType</a></li><li><a href="global.html#loadJS">loadJS</a></li><li><a href="global.html#loadCSS">loadCSS</a></li><li><a href="global.html#saveBase64ImgToFile">saveBase64ImgToFile</a></li><li><a href="global.html#turnLocalImg2Base64">turnLocalImg2Base64</a></li><li><a href="global.html#saveRemoteImgToLocal">saveRemoteImgToLocal</a></li><li><a href="global.html#getImgMd5">getImgMd5</a></li><li><a href="global.html#startPipeline">startPipeline</a></li><li><a href="global.html#randomNum">randomNum</a></li><li><a href="global.html#signatureGenerator">signatureGenerator</a></li><li><a href="global.html#genRainbowHeaderSignature">genRainbowHeaderSignature</a></li><li><a href="global.html#addOrUpdateRainbowKV">addOrUpdateRainbowKV</a></li><li><a href="global.html#addRainbowKV">addRainbowKV</a></li><li><a href="global.html#updateRainbowKV">updateRainbowKV</a></li><li><a href="global.html#createRainbowPublishJob">createRainbowPublishJob</a></li><li><a href="global.html#publishRainbowTask">publishRainbowTask</a></li><li><a href="global.html#closeRainbowTask">closeRainbowTask</a></li><li><a href="global.html#updateRainbowKVAndPublish">updateRainbowKVAndPublish</a></li><li><a href="global.html#fetchRainbowConfig">fetchRainbowConfig</a></li><li><a href="global.html#getBranchLifeCycle">getBranchLifeCycle</a></li><li><a href="global.html#getProjectDefaultBranch">getProjectDefaultBranch</a></li><li><a href="global.html#getBranchesByProjectName">getBranchesByProjectName</a></li><li><a href="global.html#getOneBranchDetail">getOneBranchDetail</a></li><li><a href="global.html#getOneCommitDetail">getOneCommitDetail</a></li><li><a href="global.html#createMR">createMR</a></li><li><a href="global.html#getMrList">getMrList</a></li><li><a href="global.html#getOneMrComments">getOneMrComments</a></li><li><a href="global.html#getOneProjectDetail">getOneProjectDetail</a></li><li><a href="global.html#getOneProjectBySearch">getOneProjectBySearch</a></li><li><a href="global.html#getAllProjects">getAllProjects</a></li><li><a href="global.html#getQueryObj">getQueryObj</a></li><li><a href="global.html#composeUrlQuery">composeUrlQuery</a></li><li><a href="global.html#isRegExp">isRegExp</a></li><li><a href="global.html#isDate">isDate</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#cached">cached</a></li><li><a href="global.html#camelize">camelize</a></li><li><a href="global.html#hyphenate">hyphenate</a></li><li><a href="global.html#capitalize">capitalize</a></li><li><a href="global.html#titleize">titleize</a></li><li><a href="global.html#extend">extend</a></li><li><a href="global.html#getThousandSeparator">getThousandSeparator</a></li><li><a href="global.html#getThousandSeparator2">getThousandSeparator2</a></li><li><a href="global.html#getCommitInfo">getCommitInfo</a></li><li><a href="global.html#isExternal">isExternal</a></li><li><a href="global.html#validURL">validURL</a></li><li><a href="global.html#validLowerCase">validLowerCase</a></li><li><a href="global.html#validUpperCase">validUpperCase</a></li><li><a href="global.html#validAlphabets">validAlphabets</a></li><li><a href="global.html#validEmail">validEmail</a></li><li><a href="global.html#isString">isString</a></li><li><a href="global.html#isArray">isArray</a></li><li><a href="global.html#isQQNumber">isQQNumber</a></li><li><a href="global.html#isEmail">isEmail</a></li><li><a href="global.html#isMobile">isMobile</a></li><li><a href="global.html#isTel">isTel</a></li><li><a href="global.html#isIdCard">isIdCard</a></li><li><a href="global.html#genVersion">genVersion</a></li><li><a href="global.html#sendWxRobotMsg">sendWxRobotMsg</a></li><li><a href="global.html#sendWxRobotMarkdown">sendWxRobotMarkdown</a></li><li><a href="global.html#sendWxRobotImg">sendWxRobotImg</a></li><li><a href="global.html#sendToRobot">sendToRobot</a></li><li><a href="global.html#sendWxRobotBase64Img">sendWxRobotBase64Img</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">city/index.ts</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import rawCityData from './data';
import { ProvType } from './type';

/**
 * 获取城市列表
 * @param data - 原始数据[provData, cityData]
 * @param areaArray - 返回的数组
 * @param allProvFlag - 是否有不限的标识
 * @returns 城市列表
 */
export function getAreaData(
  data = rawCityData,
  areaArray: Array&lt;ProvType> = [],
  allProvFlag = false,
) {
  const { cityData, provData } = data;

  Object.keys(provData).forEach((key) => {
    const provObject: ProvType = {
      text: provData[key],
      code: key,
    };
    areaArray.push(provObject);
  });

  Object.keys(cityData).forEach((key1) => {
    const cityList = cityData[key1];
    const array: Array&lt;ProvType> = [];

    if (Array.isArray(cityList)) {
      const cityObject: ProvType = {
        text: cityList[0],
        code: '0',
      };
      array.push(cityObject);
    } else {
      if (allProvFlag) {
        // 全省
        array.push({ text: '全省', code: '0' });
      }

      Object.keys(cityList).forEach((key2) => {
        const cityObject: ProvType = {
          text: cityList[key2],
          code: key2,
        };
        array.push(cityObject);
      });
    }

    for (let index = 0; index &lt; areaArray.length; index++) {
      const element = areaArray[index];
      if (element.code === key1) {
        element.children = array;
      }
    }
  });

  return areaArray;
}

/**
  * 获取如下格式的城市列表，包含`全国`、`全省`选项
  * @returns {Array} 城市列表
   @example
   ```js
   getAllAreaData();

   [{
      text: '全国',
      code: '0',
      children: [{
        text: '不限',
        code: '0',
      }],
    },
     {
       text: '北京',
       code: '11',
       children: [{
         text: '北京',
         code: '0',
       }],
     },
     {
       text: '天津',
       code: '12',
       children: [{
         text: '天津',
         code: '0',
       }],
     },
     {
       text: '河北',
       code: '13',
       children: [{
         text: '全省',
         code: '0'
         },
         {
         text: '石家庄',
         code: '1'
       },
       {
         text: '唐山',
         code: '2'
       }]
     }
   ]
   ```
  */
export function getAllAreaData() {
  const areaArray: Array&lt;ProvType> = [];

  // 全国
  const provObject: ProvType = {
    text: '全国',
    code: '0',
    children: [{ text: '不限', code: '0' }],
  };
  areaArray.push(provObject);

  getAreaData(rawCityData, areaArray, true);
  return areaArray;
}

/**
  * 根据省份城市转化为`id`数组
  * @param {string} provinceStr
  * @param {string} cityStr
  * @return {Array} 包含省份、城市ID的数组
  *
  * @example
  * ```js
    getAreaCode('山东', '德州'); // ['37', '14']
   ```
  */
export function getAreaCode(provinceStr, cityStr) {
  if (typeof provinceStr === 'undefined') {
    return [];
  }
  provinceStr = provinceStr.replace('省', '').replace('市', ''); // 考虑直辖市
  cityStr = cityStr.replace('市', '');

  const areaList = getAreaData();
  const codes: Array&lt;String> = [];

  for (let i = 0; i &lt; areaList.length; i++) {
    if (provinceStr === areaList[i].text) {
      codes[0] = areaList[i].code as String;
      const list = areaList[i].children || [];

      for (let j = 0; j &lt; list.length; j++) {
        if (cityStr === list[j].text) {
          codes[1] = list[j].code as String;
          return codes;
        }
      }
    }
  }
  return codes;
}

/**
  * 根据`id`获取省份名字
  * @param {string | number} provinceId
  * @returns {string} 省份名字
  *
  * @example
  * ```js
   getProvName(37) // 山东
   getCityName(11) // 北京
   ```
  */
export function getProvName(provinceId) {
  const provName = rawCityData.provData[provinceId];
  return provName;
}

/**
  * 根据`id`获取城市名字
  * @param {string | number} provinceId
  * @param {string | number} cityId
  * @returns {string} 城市名字
  *
  * @example
  *  ```js
    getCityName(37, 14) // 德州
    getCityName(11) // 北京
    ```
  */
export function getCityName(provinceId, cityId) {
  const provName = rawCityData.provData[provinceId];
  let cityName = '';
  const cityList = rawCityData.cityData[provinceId];

  if (Array.isArray(cityList)) {
    cityName = provName;
  } else if (cityList) {
    cityName = cityList[cityId];
  }
  return cityName;
}

/**
  * 根据`id`将省份城市转化为字符串数组
  * @param {string | number} provinceId
  * @param {string | number} cityId
  * @return {Array} 包含省份、城市名字的数组
  *
  * @example
  * ```js
   getAreaName(37, 14) // ['山东', '德州']
   getAreaName(11) // ['北京', '北京']
   getAreaName(11, 0) // ['北京', '北京']
   ```
  */
export function getAreaName(provinceId, cityId) {
  const provName = getProvName(provinceId) || '';
  const cityName = getCityName(provinceId, cityId) || '';
  return [provName, cityName];
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


    <script src="./jsdoc.js"></script>
    
</body>
</html>
